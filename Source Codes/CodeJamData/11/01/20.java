import java.util.*;public class a {	public static void main(String[] args) {		Scanner in = new Scanner(System.in);		int T = in.nextInt();		for(int t=1; t<=T; t++) {			int oPos = 1, bPos = 1;			int range = 0;			int n = in.nextInt();			int time=0;			ArrayList<Integer> orange = new ArrayList<Integer>(),									 blue = new ArrayList<Integer>();			int[] color = new int[n];			for(int i=0; i<n; i++) {				String s = in.next();				int p = in.nextInt();				if(s.charAt(0)=='O') {					color[i] = 1;					orange.add(p);				}				else {					color[i] = 2;					blue.add(p);				}			}			int i=0;			while(i<n) {				if(color[i] == 1) {					int or = orange.get(0);					if(oPos == or) {						orange.remove(0);						i++;					}					else {						oPos += or>oPos?1:-1;					}					int bl = blue.size()>0?blue.get(0):bPos;					if(bPos != bl) {						bPos += bl>bPos?1:-1;					}				}				else {					int bl = blue.get(0);					if(bPos == bl) {						blue.remove(0);						i++;					}					else {						bPos += bl>bPos?1:-1;					}					int or = orange.size()>0?orange.get(0):oPos;					if(oPos != or) {						oPos += or>oPos?1:-1;					}				}				time++;			}			System.out.printf("Case #%d: %d%n", t, time);		}	}}