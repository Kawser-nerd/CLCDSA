N = int(raw_input())
for case in xrange(1, N+1):
    Z = raw_input().split(" ")
    n = int(Z[0])
    A = int(Z[1])
    B = int(Z[2])
    C = int(Z[3])
    D = int(Z[4])
    x0 = int(Z[5])
    y0 = int(Z[6])
    M = int(Z[7])
    r = [[0,0,0],[0,0,0],[0,0,0]]
    r[x0 % 3][y0 % 3] += 1
    X = x0
    Y = y0
    for i in xrange(1, n):
        X = (A * X + B) % M
        Y = (C * Y + D) % M
        r[X % 3][Y % 3] += 1
    num = 0;    
    num += r[0][0] * (r[0][0] - 1) * (r[0][0] - 2) / 6
    num += r[1][1] * (r[1][1] - 1) * (r[1][1] - 2) / 6
    num += r[2][2] * (r[2][2] - 1) * (r[2][2] - 2) / 6
    num += r[0][1] * (r[0][1] - 1) * (r[0][1] - 2) / 6
    num += r[0][2] * (r[0][2] - 1) * (r[0][2] - 2) / 6
    num += r[1][0] * (r[1][0] - 1) * (r[1][0] - 2) / 6
    num += r[2][0] * (r[2][0] - 1) * (r[2][0] - 2) / 6
    num += r[1][2] * (r[1][2] - 1) * (r[1][2] - 2) / 6
    num += r[2][1] * (r[2][1] - 1) * (r[2][1] - 2) / 6
    num += r[0][0] * r[0][1] * r[0][2]
    num += r[0][0] * r[1][0] * r[2][0]
    num += r[0][0] * r[1][1] * r[2][2]

    num += r[0][0] * r[1][2] * r[2][1]
    num += r[1][2] * r[1][1] * r[1][0]
    num += r[1][2] * r[2][2] * r[0][2]
    num += r[1][2] * r[2][0] * r[0][1]
    
    num += r[2][1] * r[1][1] * r[0][1]
    num += r[2][1] * r[2][2] * r[2][0]
    num += r[2][1] * r[1][0] * r[0][2]

    num += r[1][1] * r[2][0] * r[0][2]
    num += r[2][2] * r[0][1] * r[1][0]
    print "Case #%d: %d" % (case, num)
